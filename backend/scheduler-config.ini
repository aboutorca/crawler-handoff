# Ofelia Scheduler Configuration for Docker-based Cron Jobs
# Used with docker-compose scheduler service

[global]
# Email settings for notifications (optional)
# smtp-host = smtp.gmail.com
# smtp-port = 587
# smtp-user = your-email@gmail.com
# smtp-password = your-app-password
# email-to = admin@company.com
# email-from = crawler@company.com

# Nightly crawler job - runs daily at 2 AM
[job-exec "nightly-crawler"]
schedule = 0 2 * * *
container = idaho-puc-nightly-crawler
command = node crawlers/nightly-crawler.js
no-overlap = true

# Weekly full scan - runs every Sunday at 3 AM
[job-exec "weekly-full-scan"]
schedule = 0 3 * * 0
container = idaho-puc-nightly-crawler
command = node crawlers/nightly-crawler.js
environment = ["NIGHTLY_MAX_WORKERS=10"]
no-overlap = true

# Health check - runs every 30 minutes
[job-exec "health-check"]
schedule = */30 * * * *
container = idaho-puc-health-check
command = node crawlers/nightly-crawler.js --health
no-overlap = true

# Cleanup old checkpoints - runs daily at 4 AM
[job-exec "cleanup"]
schedule = 0 4 * * *
container = idaho-puc-historical-crawler
command = find /app/data -name "*.checkpoint.json" -mtime +7 -delete
no-overlap = true

# Optional: Monthly historical refresh for recent year
# [job-exec "monthly-refresh"]
# schedule = 0 1 1 * *
# container = idaho-puc-historical-crawler
# command = node crawlers/historical-crawler.js
# environment = ["CRAWLER_START_YEAR=2024", "CRAWLER_END_YEAR=2024", "CRAWLER_MAX_WORKERS=15"]
# no-overlap = true